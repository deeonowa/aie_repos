# HW07 – Report

> Файл: `homeworks/HW07/report.md`  

## 1. Datasets

Вы выбрали 3 датасета из 4 (перечислите):

### 1.1 Dataset A

- Файл: S07-hw-dataset-01.csv
- Размер: (12000, 9)
- Признаки: числовые
- Пропуски: нет
- "Подлости" датасета: Числовые признаки в разных шкалах + шумовые признаки

### 1.2 Dataset B

- Файл: S07-hw-dataset-02.csv
- Размер: (8000, 4)
- Признаки: числовые
- Пропуски: нет
- "Подлости" датасета: Нелинейная структура + выбросы + лишний шумовой признак.

### 1.3 Dataset C

- Файл: S07-hw-dataset-03.csv
- Размер: (15000, 5)
- Признаки: числовые
- Пропуски: нет
- "Подлости" датасета: Кластеры разной плотности + фоновый шум. 

## 2. Protocol

- Препроцессинг: scaling, PCA
- Поиск гиперпараметров:
  - диапазон параметров для KMeans (k): от 2 до 20 
  - диапазон параметров для DBSCAN (eps/min_samples): (от 0,5 до 5/от 3 до 50)
  - при выборе "лучшего" руководствовались показателем silhouette
- Метрики: silhouette / Davies-Bouldin / Calinski-Harabasz (метрики считались на non-noise точках)
- Визуализация: PCA(2D)

## 3. Models


- KMeans (поиск `k`, фиксировали `random_state`, `n_init`)
- DBSCAN (`eps`, `min_samples`, доля шума)

## 4. Results

### 4.1 Dataset A

- KMeans: k: 2

- metrics: 
-   silhouette: 0.5216395622404243,
-   davies_bouldin: 0.6853295219054455,
-   calinski_harabasz: 11786.954622671543

- Метрики двух методов одинаковые. Выбран KMeans так как он быстрее.

### 4.2 Dataset B

- DBSCAN: eps: 0.5, min_samples: 10

- metrics: 
-  silhouette: 0.2512022545940147,
-  davies_bouldin: 0.7420731639720551,
-  calinski_harabasz: 26.168575636304755,
- noise_frac: 0.063625

- DBSCAN нашел нелинейные кластеры и лучше выделил выбросы

### 4.3 Dataset C

- KMeans: k: 3

- metrics:
-  silhouette: 0.31553248183109267,
-  davies_bouldin: 1.157783224021114,
-  calinski_harabasz: 6957.158106946742

- KMeans ссправился лучше за счет равномерного разделения пространства.

## 5. Analysis

### 5.1 Сравнение алгоритмов (важные наблюдения)

- KMeans "ломается" при нелинейной структуре и неоднородной плотности из-за принципа построения кластеров и сложности работы с произвольными формами.
- DBSCAN в свою очередь автоматически выделяет шум и работает с произвольными формами, поэтому выигрывает при этих условиях.
- Масштабирование сильнее всего влияло на результат так как без него метрики сильно падали.

### 5.2 Устойчивость (обязательно для одного датасета)

- 5 запусков KMeans по разным seed
- Параметры ARI и NMI не менялись из-за изменений seed, что говорит об устойчисовсти. Также сильно не изменялся параметр Silhouette.
- Вывод: Устойчиво, потому что данные хорошо разделимы

### 5.3 Интерпретация кластеров

- Как вы интерпретировали кластеры:
  - профили признаков (средние) 
- На примере второго датасета: множество показателей, близких к единице, были объединены в один кластер. Показатели, близкие к нулю, были объединены во второй кластер, остальные не сопоставлялись между собой и были определены как выбросы. PCA(2D) подтверждает, что кластеры визуально разделены.

## 6. Conclusion

- StandardScaler обязателен для методов, основанных на расстоянии — без него метрики бесполезны.
- KMeans используется для шарообразных/равноплотных кластеров.
- DBSCAN используется при нелинейности, работает при разных формах, но чувствителен к eps при разной плотности.
- Внутренние метрики (silhouette/DB/CH) обязательны, но визуализация PCA(2D) не менее важна для определения корректности разделения на кластеры.
- Важна проверка устойчивости 
